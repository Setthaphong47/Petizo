<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° - Petizo</title>

    <!-- ‚ö° Preload Critical Resources -->
    <link rel="preload" href="/css/navbar.css" as="style">
    <link rel="preload" href="/js/navbar.js" as="script">
    <link rel="preload" href="/icon/cat.png" as="image">
    
    <!-- üé® Navbar CSS (‡πÅ‡∏¢‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß - ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å cache) -->
    <link rel="stylesheet" href="/css/navbar.css">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f8f9fa;
            line-height: 1.8;
        }

        /* Breadcrumb */
        .breadcrumb {
            padding: 20px 40px;
            background: white;
            border-bottom: 1px solid #e9ecef;
            font-size: 14px;
        }

        .breadcrumb a {
            color: #6c757d;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            color: #000;
        }

        /* Article Container */
        .article-container {
            background: white;
            min-height: 100vh;
        }

        /* Article Header */
        .article-header {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 40px 30px;
            text-align: center;
        }

        .article-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #000;
            margin-bottom: 20px;
            line-height: 1.3;
        }

        .article-meta {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            color: #6c757d;
            font-size: 14px;
            flex-wrap: wrap;
        }

        .article-meta span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-badge {
            background: #00bcd4;
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        /* Article Image */
        .article-image {
            width: 100%;
            max-height: 500px;
            overflow: hidden;
            background: linear-gradient(135deg, #00d4ff 0%, #00bdeb 100%);
        }

        .article-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .article-image-placeholder {
            width: 100%;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 120px;
        }

        /* Article Content */
        .article-content {
            max-width: 900px;
            margin: 0 auto;
            padding: 50px 40px;
        }

        .article-content p {
            margin-bottom: 20px;
            color: #333;
            font-size: 1.05rem;
            line-height: 1.8;
        }

        .article-content h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .article-content h3 {
            color: #000;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.4rem;
            font-weight: 600;
        }

        .article-content ul, .article-content ol {
            margin: 20px 0 20px 30px;
            color: #333;
        }

        .article-content li {
            margin-bottom: 10px;
            line-height: 1.7;
        }

        /* Article Footer */
        .article-footer {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 40px 50px;
            border-top: 1px solid #e9ecef;
            padding-top: 30px;
        }

        .tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 20px;
        }

        .tags-label {
            font-weight: 600;
            color: #666;
        }

        .tag {
            background: #f8f9fa;
            color: #495057;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
        }

        .article-source {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            font-size: 14px;
        }

        .article-source strong {
            color: #000;
        }

        .article-source a {
            color: #667eea;
            word-break: break-all;
        }

        .article-stats {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            color: #6c757d;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            padding: 100px 20px;
            color: #999;
        }

        .error {
            text-align: center;
            padding: 100px 20px;
            color: #dc3545;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 12px 20px;
            }

            .breadcrumb {
                padding: 15px 20px;
            }

            .article-header {
                padding: 30px 20px 20px;
            }

            .article-title {
                font-size: 1.8rem;
            }

            .article-content {
                padding: 30px 20px;
            }

            .article-footer {
                padding: 20px 20px 40px;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <div id="navbar-container"></div>

    <!-- ‚ö° ‡πÇ‡∏´‡∏•‡∏î Navbar JavaScript ‡∏Å‡πà‡∏≠‡∏ô -->
    <script src="/js/navbar.js"></script>
    
    <!-- üìú ‡πÇ‡∏´‡∏•‡∏î Config ‡πÅ‡∏•‡∏∞ Scripts ‡∏≠‡∏∑‡πà‡∏ô‡πÜ -->
    <script src="/js/config.js"></script>
    <script src="/js/profile-dropdown.js"></script>
    <script src="/js/auth-common.js"></script>

    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="index.html">Home</a> >> <a href="blog.html">Blog</a> >> <span id="breadcrumbTitle">...</span>
    </div>

    <!-- Article Container -->
    <div id="articleContainer" class="article-container">
        <div class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°...</div>
    </div>

    <script src="/js/config.js"></script>
    <script>
        const API_URL = CONFIG.API_URL;

        // Handle Your Pet link click
        function handleYourPetClick(event) {
            event.preventDefault();
            var token = localStorage.getItem('token');
            
            if (!token) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡πâ‡∏≤ Your Pet');
                window.location.href = 'login.html';
            } else {
                window.location.href = 'your-pet.html';
            }
        }

        // Get slug from URL
        function getSlugFromURL() {
            var urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('slug');
        }

        // Load article
        async function loadArticle() {
            var slug = getSlugFromURL();
            
            if (!slug) {
                document.getElementById('articleContainer').innerHTML = '<div class="error"><h2>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</h2><p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô</p></div>';
                return;
            }

            try {
                var response = await fetch(API_URL + '/blog/' + slug);
                
                if (!response.ok) {
                    throw new Error('Article not found');
                }
                
                var article = await response.json();
                displayArticle(article);
            } catch (error) {
                console.error('Error loading article:', error);
                document.getElementById('articleContainer').innerHTML = '<div class="error"><h2>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°</h2><p>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p></div>';
            }
        }

        // Display article
        function displayArticle(article) {
            var container = document.getElementById('articleContainer');
            
            // Update page title and breadcrumb
            document.title = article.title + ' - Petizo';
            document.getElementById('breadcrumbTitle').textContent = article.title;
            
            // Format date
            var publishedDate = new Date(article.published_at || article.created_at);
            var formattedDate = publishedDate.toLocaleDateString('th-TH', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
            
            // Parse tags
            var tags = [];
            if (article.tags) {
                var tagArray = article.tags.split(',');
                for (var i = 0; i < tagArray.length; i++) {
                    var tag = tagArray[i].trim();
                    if (tag) {
                        tags.push(tag);
                    }
                }
            }
            
            // Format content with paragraphs
            var formattedContent = article.content
                .split('\n')
                .map(function(line) { return line.trim(); })
                .filter(function(line) { return line; })
                .map(function(line) { return '<p>' + line + '</p>'; })
                .join('');
            
            // Build HTML
            var html = '';
            
            // Header
            html += '<div class="article-header">';
            html += '<h1 class="article-title">' + article.title + '</h1>';
            html += '<div class="article-meta">';
            html += '<img src="/icon/calendar (2).png" alt="Date" style="width:20px;height:20px;">' + formattedDate + '</span>';
            html += '<img src="/icon/writing.png" alt="Writer" style="width:20px;height:20px;">' + (article.author_name || '‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô') + '</span>';
            if (article.category) {
                html += '<span class="category-badge">' + article.category + '</span>';
            }
            html += '</div></div>';
            
            // Image
            html += '<div class="article-image">';
            if (article.featured_image) {
                html += '<img src="' + article.featured_image + '" alt="' + article.title + '">';
            } else {
                html += '<div class="article-image-placeholder">üê±</div>';
            }
            html += '</div>';
            
            // Content
            html += '<div class="article-content">' + formattedContent + '</div>';
            
            // Footer
            html += '<div class="article-footer">';
            
            // Tags
            if (tags.length > 0) {
                html += '<div class="tags">';
                html += '<span class="tags-label"><img src="/icon/bookmark.png" alt="Tag" style="width:20px;height:20px;"></span>';
                for (var i = 0; i < tags.length; i++) {
                    html += '<span class="tag">' + tags[i] + '</span>';
                }
                html += '</div>';
            }
            
            // Source (example)
            html += '<div class="article-source">';
            html += '<strong><span class="tags-label"><img src="/icon/durability.png" alt="Refer" style="width:20px;height:20px;"></strong> https://pets.baanlae‡∏™‡∏ß‡∏ô.com/329196/pet-health/can-cat-cry';
            html += '</div>';
            
            // Stats
            html += '<div class="article-stats">';
            html += '<span><img src="/icon/view.png" alt="View" style="width:20px;height:20px;"> 10</span>';
            html += '<span><img src="/icon/calendar (2).png" alt="Date" style="width:20px;height:20px;"> ' + formattedDate + '</span>';
            html += '</div>';
            
            html += '</div>';
            
            container.innerHTML = html;
        }

        // Load article on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            loadArticle();
        });
    </script>

</body>
</html>